# Kinectron Client Development Guide

## Project Structure

The Kinectron client consists of:

- **src/**: Modern ES module source files for the client library
- **examples/**: Example applications and testing interfaces
  - **streamTest/**: Stream testing interface with visualization tools
  - **test/**: Simple connection testing interface
- **dist/**: Build output directory (generated by Parcel)

## Development Workflow

### Running the Stream Test

To run the stream test interface:

```bash
npm run test:stream
```

This will:

1. Clean the Parcel cache and dist directory
2. Build the client library from src/index.js
3. Start a development server with the streamTest example
4. Open the page in your default browser

### Building the Client Library

To build the client library:

```bash
npm run build
```

This will:

1. Clean the Parcel cache and dist directory
2. Build the client library from src/index.js
3. Output the result to the dist directory

## Known Issues and Solutions

### Parcel Caching Issues

When making changes to JavaScript files that are directly included in HTML (not imported via ES modules), you may encounter issues with Parcel's caching mechanism. Changes to these files might not be reflected in the browser even when using the development server with hot reloading.

#### Symptoms

- Changes to files in the `examples/streamTest/js/controllers/` directory don't appear in the browser
- Console logs show old code is still running
- UI behavior doesn't match your updated code

#### Solution

If you encounter caching issues, you can manually clear Parcel's cache:

```bash
# From the client directory
rm -rf .parcel-cache dist
npm run test:stream
```

The npm scripts have been updated to automatically clear the cache before each run, but if you're still experiencing issues, you can run the clean script manually:

```bash
npm run clean
```

### Direct DOM Manipulation

Some parts of the codebase use direct DOM manipulation to enable/disable UI elements. When refactoring or modifying UI-related code, be aware that there might be multiple places where the same DOM elements are being manipulated.

For example, the stream buttons in examples/streamTest/index.html are controlled by:

1. The initial HTML attributes (`disabled`)
2. The UIController.js methods (`enableStreamButtons`, `disableStreamButtons`)
3. Direct DOM manipulation in event handlers

When making changes to UI behavior, make sure to check all these locations to ensure consistent behavior.

## Best Practices

1. **Use ES Modules**: When possible, use ES module imports rather than direct script tags in HTML
2. **Test Changes Thoroughly**: After making changes, test all related functionality to ensure nothing was broken
3. **Clear Cache When Needed**: If you suspect caching issues, clear the Parcel cache
4. **Check Console Logs**: Use the browser console to verify that your changes are being loaded correctly
