{"mappings":"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","sources":["examples/streamTest/js/controllers/visualizationController.js"],"sourcesContent":["/**\r\n * VisualizationController\r\n * Manages visualization strategies for different stream types\r\n */\r\nclass VisualizationController {\r\n  constructor() {\r\n    // Cache DOM elements\r\n    this.elements = {\r\n      canvasContainer: document.getElementById('canvas-container'),\r\n      threeContainer: document.getElementById('three-container'),\r\n    };\r\n\r\n    // Visualization state\r\n    this.p5Canvas = null;\r\n    this.threeVisualizer = null;\r\n\r\n    // Initialize visualizers\r\n    this._initializeVisualizers();\r\n  }\r\n\r\n  /**\r\n   * Initialize the controller\r\n   * @returns {VisualizationController} - The initialized controller instance\r\n   */\r\n  static initialize() {\r\n    const controller = new VisualizationController();\r\n    return controller;\r\n  }\r\n\r\n  /**\r\n   * Initialize visualizers\r\n   * @private\r\n   */\r\n  _initializeVisualizers() {\r\n    // Initialize Three.js visualizer\r\n    this.threeVisualizer = ThreeVisualizer.initialize();\r\n\r\n    // Initialize P5 visualizer\r\n    this.p5Visualizer = P5Visualizer.initialize();\r\n\r\n    // Show p5 canvas by default\r\n    this.showP5Canvas();\r\n  }\r\n\r\n  /**\r\n   * Show p5 canvas and hide Three.js canvas\r\n   */\r\n  showP5Canvas() {\r\n    if (this.elements.canvasContainer) {\r\n      this.elements.canvasContainer.style.display = 'block';\r\n    }\r\n\r\n    if (this.elements.threeContainer) {\r\n      this.elements.threeContainer.style.display = 'none';\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Show Three.js canvas and hide p5 canvas\r\n   */\r\n  showThreeCanvas() {\r\n    if (this.elements.canvasContainer) {\r\n      this.elements.canvasContainer.style.display = 'none';\r\n    }\r\n\r\n    if (this.elements.threeContainer) {\r\n      this.elements.threeContainer.style.display = 'block';\r\n    }\r\n\r\n    // Initialize Three.js if not already initialized\r\n    if (!this.threeVisualizer.isInitialized()) {\r\n      this.threeVisualizer.initialize();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Resize p5 canvas\r\n   * @param {number} width - Canvas width\r\n   * @param {number} height - Canvas height\r\n   */\r\n  resizeP5Canvas(width, height) {\r\n    if (this.p5Visualizer) {\r\n      this.p5Visualizer.resizeCanvas(width, height);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear p5 canvas\r\n   */\r\n  clearP5Canvas() {\r\n    if (this.p5Visualizer) {\r\n      this.p5Visualizer.clearCanvas();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Display color frame on p5 canvas\r\n   * @param {Object} frame - Color frame data\r\n   */\r\n  displayColorFrame(frame) {\r\n    if (this.p5Visualizer) {\r\n      this.p5Visualizer.displayColorFrame(frame);\r\n    } else {\r\n      console.warn('P5Visualizer not initialized');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Display depth frame on p5 canvas\r\n   * @param {Object} frame - Depth frame data\r\n   */\r\n  displayDepthFrame(frame) {\r\n    if (this.p5Visualizer) {\r\n      this.p5Visualizer.displayDepthFrame(frame);\r\n    } else {\r\n      console.warn('P5Visualizer not initialized');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update point cloud with depth values\r\n   * @param {Uint16Array} depthValues - Raw depth values\r\n   */\r\n  updatePointCloud(depthValues) {\r\n    if (this.threeVisualizer) {\r\n      this.threeVisualizer.updatePointCloud(depthValues);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Display skeleton frame\r\n   * @param {Object} frame - Skeleton frame data with bodies array\r\n   */\r\n  displaySkeletonFrame(frame) {\r\n    // Always log this regardless of debug flags to help diagnose the issue\r\n    console.error(\r\n      'VisualizationController: displaySkeletonFrame called',\r\n    );\r\n    console.error('Frame type:', typeof frame);\r\n    console.error('Frame has bodies:', frame && !!frame.bodies);\r\n\r\n    if (frame && frame.bodies) {\r\n      console.error('Bodies count:', frame.bodies.length);\r\n\r\n      if (frame.bodies.length > 0) {\r\n        console.error(\r\n          'First body has skeleton:',\r\n          !!frame.bodies[0].skeleton,\r\n        );\r\n\r\n        if (\r\n          frame.bodies[0].skeleton &&\r\n          frame.bodies[0].skeleton.joints\r\n        ) {\r\n          const firstJoint = frame.bodies[0].skeleton.joints[0];\r\n          console.error('First joint:', firstJoint);\r\n          console.error('Joint properties:', Object.keys(firstJoint));\r\n          console.error('Joint has depthX:', 'depthX' in firstJoint);\r\n          console.error('Joint has depthY:', 'depthY' in firstJoint);\r\n          console.error(\r\n            'Joint has cameraX:',\r\n            'cameraX' in firstJoint,\r\n          );\r\n          console.error(\r\n            'Joint has cameraY:',\r\n            'cameraY' in firstJoint,\r\n          );\r\n        }\r\n      }\r\n    }\r\n\r\n    if (window.DEBUG && window.DEBUG.DATA) {\r\n      console.group('VisualizationController: displaySkeletonFrame');\r\n      console.log('Frame received:', frame);\r\n      console.log('Bodies:', frame.bodies ? frame.bodies.length : 0);\r\n      if (\r\n        frame.bodies &&\r\n        frame.bodies.length > 0 &&\r\n        frame.bodies[0].skeleton\r\n      ) {\r\n        console.log(\r\n          'First joint:',\r\n          frame.bodies[0].skeleton.joints[0],\r\n        );\r\n        console.log(\r\n          'Joint properties:',\r\n          Object.keys(frame.bodies[0].skeleton.joints[0]),\r\n        );\r\n      }\r\n      console.groupEnd();\r\n    }\r\n\r\n    if (this.p5Visualizer) {\r\n      console.error('Calling p5Visualizer.displaySkeletonFrame');\r\n      try {\r\n        this.p5Visualizer.displaySkeletonFrame(frame);\r\n      } catch (error) {\r\n        console.error(\r\n          'Error in p5Visualizer.displaySkeletonFrame:',\r\n          error,\r\n        );\r\n      }\r\n    } else {\r\n      console.warn('P5Visualizer not initialized');\r\n    }\r\n  }\r\n}\r\n"],"names":[],"version":3,"file":"index.86af8ce3.js.map","sourceRoot":"/__parcel_source_root/"}